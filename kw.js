/***********************************

// ==UserScript==
// @ScriptName        酷我音乐[VIP+净化]
// @Author            @ddgksf2013
// @TgChannel         https://t.me/ddgksf2021
// @Contribute        https://t.me/ddgksf2013_bot
// @Feedback          📮 ddgksf2013@163.com 📮
// @UpdateTime        2025-08-31
// @Attention         使用中若有问题请发邮件！
// @Suitable          自行观看“# > ”注释内容
// @Attention         如需引用请注明出处，谢谢合作！
// @Version           V2.0.46
// @ScriptURL         https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
// ==/UserScript==


1、本重写仅限本人使用，严禁传播或售卖
2、解锁VIP歌曲，VIP听书，VIP装扮
3、全面净化去除酷我音乐广告
4、脚本工作原理为音源替换而非破解
5、若需要更高音质请付费支持歌手


[rewrite_local]


# > 通用广告请求@ddgksf2013
https?:\/\/vip1\.kuwo\.cn\/vip\/activity\/kwMemberDay url reject-200
https?:\/\/mc\.tencentmusic\.com\/sdk\/ad url reject-200
# > 屏蔽热词@ddgksf2013
https?:\/\/hotword\.kuwo\.cn\/hotword\.s url reject-200
# > 通用广告请求@ddgksf2013
https?:\/\/vip1\.kuwo\.cn\/vip_adv\/ url reject-200
# > 通用广告请求@ddgksf2013
https?:\/\/wapi\.kuwo\.cn\/openapi\/v1\/app\/pasterAdvert url reject-200
# > 应用内弹窗及右下角@ddgksf2013
^https?:\/\/mobilead\.kuwo\.cn\/ url reject-200
# > 搜索框处理@ddgksf2013
https?:\/\/searchrecterm\.kuwo\.cn\/recterm\.s url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 会员页广告@ddgksf2013
https?:\/\/appi\.kuwo\.cn\/kuwopay\/vip-tab\/page\/cells url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 会员页顶部广告tab@ddgksf2013
https?:\/\/appi\.kuwo\.cn\/kuwopay\/vip-tab\/setting url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 开屏广告@ddgksf2013
https?:\/\/rich\.kuwo\.cn\/AdService url reject-200
# > 数字专辑@ddgksf2013
^https?:\/\/musicpay\.kuwo\.cn\/music\.pay\?newver url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 听书权限接口1@ddgksf2013
^https?:\/\/[a-z0-9A-Z]+\.(kuwo|lrts)\.(cn|me)\/a\.p url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 听书权限接口2@ddgksf2013
^https?:\/\/.*\.kuwo\.cn\/v2\/api\/pay\/vip\/extraVipStatus url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 新版vip接口1@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/enc\/user\/vip\?op=ui url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 新版vip接口2@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/userbase\/vip\?op=get url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 旧版vip接口@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/user\/vip\?(uid|op=ui) url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 皮肤解锁@ddgksf2013
^https?:\/\/vip1\.kuwo\.cn\/vip\/v2\/theme url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 下载接口@ddgksf2013
^https?:\/\/musicpay\.kuwo\.cn\/music\.pay\?ui url script-request-header https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 我的页面卡片@ddgksf2013
^https?:\/\/appi.kuwo.cn/kuwopay/personal/cells url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js
# > 音乐播放接口@ddgksf2013
^https:\/\/[a-z0-9A-Z]+\.kuwo\.cn\/mobi\.s\?f=kwxs url script-response-body https://gist.githubusercontent.com/ddgksf2013/0f76e952f0c4a2579932f45a209b40c3/raw/mykkmusic.vip.js


[mitm]

hostname = *.kuwo.cn, *.lrts.me, mc.tencentmusic.com

***********************************/



const version = 'V1.0.16';

const $ = new Env("KW");
var _0xodp='jsjiami.com.v7';var _0x3f65f1=_0x43dd;(function(_0x3316ca,_0x55cc36,_0x3d9bcb,_0x1e5814,_0x4d4040,_0x249129,_0x5abbb1){return _0x3316ca=_0x3316ca>>0x3,_0x249129='hs',_0x5abbb1='hs',function(_0x4f9891,_0x2e9121,_0x568298,_0x514c03,_0x385193){var _0x4befd9=_0x43dd;_0x514c03='tfi',_0x249129=_0x514c03+_0x249129,_0x385193='up',_0x5abbb1+=_0x385193,_0x249129=_0x568298(_0x249129),_0x5abbb1=_0x568298(_0x5abbb1),_0x568298=0x0;var _0x275ab9=_0x4f9891();while(!![]&&--_0x1e5814+_0x2e9121){try{_0x514c03=-parseInt(_0x4befd9(0x1b7,'$qW['))/0x1+-parseInt(_0x4befd9(0x18d,'tnzx'))/0x2+-parseInt(_0x4befd9(0x148,'PV&M'))/0x3*(parseInt(_0x4befd9(0x1a2,'cVMO'))/0x4)+-parseInt(_0x4befd9(0x1f2,'cVMO'))/0x5*(-parseInt(_0x4befd9(0x19c,'3*Iw'))/0x6)+-parseInt(_0x4befd9(0x1a7,'@XS*'))/0x7+parseInt(_0x4befd9(0x1cd,'yeoR'))/0x8*(-parseInt(_0x4befd9(0x171,'nPYI'))/0x9)+parseInt(_0x4befd9(0x192,'3zC#'))/0xa;}catch(_0xe24fdd){_0x514c03=_0x568298;}finally{_0x385193=_0x275ab9[_0x249129]();if(_0x3316ca<=_0x1e5814)_0x568298?_0x4d4040?_0x514c03=_0x385193:_0x4d4040=_0x385193:_0x568298=_0x385193;else{if(_0x568298==_0x4d4040['replace'](/[AqOMtWDHVCNBhrFyXIJn=]/g,'')){if(_0x514c03===_0x2e9121){_0x275ab9['un'+_0x249129](_0x385193);break;}_0x275ab9[_0x5abbb1](_0x385193);}}}}}(_0x3d9bcb,_0x55cc36,function(_0x5b4100,_0x13553d,_0x3df3e5,_0x5ce129,_0x38f894,_0x5b6ab2,_0xd4243b){return _0x13553d='\x73\x70\x6c\x69\x74',_0x5b4100=arguments[0x0],_0x5b4100=_0x5b4100[_0x13553d](''),_0x3df3e5='\x72\x65\x76\x65\x72\x73\x65',_0x5b4100=_0x5b4100[_0x3df3e5]('\x76'),_0x5ce129='\x6a\x6f\x69\x6e',(0x1b2a71,_0x5b4100[_0x5ce129](''));});}(0x638,0x52e15,_0x523a,0xc9),_0x523a)&&(_0xodp=_0x523a);let method=$request['method'];function _0x523a(){var _0x5514de=(function(){return[_0xodp,'XrWjtsOjqiaIrmHhiFV.JcomN.Iv7XHByADHMCHn==','WQvtWRhcVweHW6zWcNGjW5bEmh7cTmoIs8kungmaWORcVY4kWRFdKmkAaWxdL8o1wLusW4NcPbeHgrv1WQ/cQSkCW44QWOulWRVdJCkMWPrGWRSQWOWRW7pcVhldKmoJhgfNW5K','bgJcRSovWOfZu8orzdGKESkjaW','W5C7yI8','s8oEWRqip8kQW5S','n8k0WOlcImkmC8k2WORdSgBdI8khca','u2RcRq','WO3cKsbE','o8o8WO1Kuq','qh/dLYO','ESonmv0','mSkZWOBcI8koESkYW6pcQHNcSSoNCG','zJRcL8owWORdOgJcPvRdQq','DCoxkfFcQbBcQeNcMx8XrSo9tvCPhYbyvL3cPmoNcmoLW5K','WOjApZvUWQNdNa','pwddMmom','W5FcPCoTWPKJftLbvfddPx7cNbbGzMLRzJVcP8keW4ZdTSkGydOayM/cNItdLCkuW67dMbxdHr10WR4WnLKiW5tcKrjkWRjgW4ZdGSoZyg7cO2ZcGqBcICoTowvogW','W78XEa','jbKy','6isn5P2Q5yEN6lEw5lYN55AC77+Y5PsE6lEn6kYN5lMJ5OMu77Yf','WPFdMvKPEmoyWQj8','jCo/WRDRWQ9sWP5TiMpdQsy','WO3cOSojW4qsESoU','W5VdJNqxW4OMWOBdI2yWWRTpcW','Amoll03cSq','WRiKWQOB','WQhcHeP8pCkAW5pcRfLGWOnvxum','vmkzl8kt','jb55zY0OWQVdI8kZv2z9xH/dICoBb8k5W4yEWOddO0nnWRvdW4VdMYDPWONdVMFcIqPNW5verSooqaRdGrSLW6PYEbRdQSkbW7PulGGMW5b4vq/cS8k2WQldPCkdWRXJWOVdKvBcGSkqksNcGgyAzWJcUCodWRjWWOBcI8o6WRTlD3FdLCkiWR/dKXZcI1z1WRP9W7ZcVCocdSoFpmoyWRvNWO7dTCoIW64BBSkIW7G5mCkP','vmkInCk5ma','WRZdKJuqB8kEnsq','W4qwbL4','FfmmW5ZdMfpcT1O+xSkdA8oQWP7cOW9hWOTOjCkTWODiDCoQW746ueBdGg5PWRRdICoaB8kaWOJdPCoUW7BdHmo8AmoOWO1lmctcTSo0W5z5WQDLW7H7dgxcVHXic1dcPLNdScO','a8ondmkqmmohp1S','CYFdNSko','WOqyrCoNb8ku','W5DjbSkOu8omySkWDbOctW','WPZdQCoqW4KnbmksASk5','eCo+WPz6vSoLyq','WPPMW4PkW5VcKKmSWPmAW78Q','ASoQW5BdNCoedmoG','WPpcVxhcKSkeW5ddLG','WOW+aSkWpepcLCkenbJdPmoyW5G','W6KAWR0','WP5gnW','e3pcKmoFzYuW','WR/dIsK','W5lcGt5UomkiW7HcnIRdOSkEsq','WRixlqJdLW','WOpdU8oYW5KFiG','WPhcUxpcJCka','k2tdNmobsu3dOW','W5ORWO0w','W41pwmoiCd/cIYy6WQ/dMb9uWQFdSCkQ','WP16WRFdOa','W4S6zxtcHW','WRezmrZdGq','ECo2i2dcQY7dTWxcKCosWOBdOmk5','Cs/dHSkBpCog','WRqQWROd','dI/dICknpG','pavHFJ1R','zcpdNSkloCoaWP8','WOjOl34QB8opWOFcGmopWR/cNa','WOpcT2xcHW','W4FdV8oUWPmUbCkW','W7qHWRenWR0cnZSkzmoNWQG','WOhdV8oTW5G','W4ZcPCoRWOa+sh8ira','W5JcTmoTWQq/qwig'].concat((function(){return['W7tdLWOO','DfTtW6O','bmk0pMr0','zmoHW4y','nKFdO8ksW4q','e8kcW6LDDSoDW47dGCoQW7VdJIi','rhFcPCoa','iuNdUCku','Fmono0e','EeGF','B8oIW7dcJgxcOGhdTmoHW7tdQWLZbW','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','W6xcLg8Kyd7dMmkekIj5W4z1qWi','WQSyoX7dISo0WPa','W43cRmkRWPTmACkTzmkojWeb','WQ5YWO3dJei','swZcKW','W4LQsmoY','W7qCWQxcPW','WR1xWPxcMgq','WRDEWOVdNW','E8k7lYRcQwtdVrVdTSo2W7y','Bmo2ja','CmoWW4ddKCosjmoVW5ZcUq','aNCJumoMWRTF','WOrgW4noW5C','W5CXn33cIq','kmk5WRtdRs7dQ1tcTW','WPDHWQFdQCoJWPxcISoxnSk8WOlcUmkKWRBcKsPcW73cTwtdR1pcThzrWOldG8kHdmkMFCoCi8oaEIjMWO9YaepcLCods8k9nSkHW7lcHIuyw0ZcGSoGWR7cVSo/WQ5xW6yHWPvUWPdcPG','gYbdASoEW5nV','W4NdOmoWWPtdI8kyoZC','WRyfWRhcPh9+WRORaNGyWPublYpdTSkHfSkkyJGDW5xdTIniWRddKSkurH/cI8oOvuuoWOVcPr4Vhq5KW6FcPSkEW54OWPWdW67cM8o1WPzPW64UWOG+W6FdTghdI8o6xxuRWOtcVNe0WR/cRYBcRLpdJWZdKaO1eCkJWO7dKrlcVf0dEsHRWRqTjCk1xwfFfmklWRuFe8ktaCkctSonn8k9scZdKg7dMmkhCaHVq8obtcaYW4NdUSkh','wh/cI8oC','Fd3cVmoAWOxdTvtcSey','imk1WOpcICknCSk3','F2VcI8ojyM4LE8oVfUodM+IgJEEvSEwEJW','WQKdkbtdGSoAWO9qWPfQCSoDvwNdImoYpchdRCkHWQPO','W7OIzN7cQG','fhmNxq','WOJcTMxcM8kDW7ZdLq','W49Qs8oQBXBdIa','W59Gx8o/','lmk1WRtdLtBdUfq','uKCbCmkL','WO9LWOpdJmoM','cI3cNCozoMLYiSkStmkavbhdNJnsu0OkWRaFimoWgG','W4GdbK/cT3GpW5JdISkeASkwhw09rI8llSkfdCoTtXNcMG','W5ddSSoGWPldLW','W41Et8oCnYFcHsW','AYJcUSos','W7xdOSk/EHBcQ8okve0','WO46BmoKyrldG8kp','bNZdJd5AsmkhhmkCnColW5i+gq','tNVcJ8orB2GM','W5SGWPe','rmkDkmkg','WPRcJcG','ASoGW7tcIwFcQWhdTmkxWRhcKfCV','zKiiW4ddIGRdVq','bL7dQSkSW7O','W47cTw7cNmkmWP3dGa','BSoJW4RdKmoikCkOW5hcTshcLmkzw8oA','FmkfW4ytW4e','hmkUpq','muhdUCkzW5i','emoTWPb0','qmoFWRqu','WRZdKJuPqSkdkcHjW5u','sCkEdmkqga','W4aiuMVcUW'].concat((function(){return['eN03rq','WR7cTSkgWQddSxS6W4xdJ8o1W4/dQ8ke','W5mbAgiHW5tdU04HW6buWRq','vNVdKYDCq8kw','bcJdISkkodmpECozpCobpG','WQtcHK55p8ktW5pcRc8LW7Glaq','xmkrkmkg','eSk8lJOQ','W4/dPmoUWP85','W4GKWQv5','W53dOCoMWP8I','W4uZzGfTmSooWO7cPmoyWP/cICkXxbxdPu0','W4iyfKy','WQldHcLzjhhcNCofz1C4WO8V','W5OHWOGA','omkIWQhdNa','jNSJF8oMWQPE','W7FcNgSj','W4RdSmo+WPC','BCkfWRldTshdJf4','W77dKXSTtCokWOBdUgW','pmk/WQddGa','fSkaW6bDD8ovWO3cQ8kBWR3cRuiy','pG99EZ9XW6e','W5RdQmo6WPm','W74hWRxcRG','oCk1WRddJZBdTW','WOXWWQFdR8oXW4m','W5RdICoLW4q','W6auma7dLCotWOiGWPDMCmoXx2NdJCk8kxBcSmo8W7CPW7aAv0Pi','W4uNWOOCWP7dH3TOWO8QW7LtW4RdIYLXW7VdLXa7tSkaiG','W45GvCoHFq','bgSJwq','sN/cK8oiA3G','W58XWQnXFCkRWO3dOCkF','D8oTW5/dNq','WQazoWi','WOhdMw4K','fu3cT8o1WP5hrq','WOBdRmo3W5W','lGvPBG','kaT5DG','WO18WRddSCk+W4tdKmkpmmo/WOdcSCoUW5NcNGXqW6ddRw7dOHK','uNFdKX9eumkwma','WOddQmoY','FtdcKG','W5SHWPGb','WRLgWQC','FuycW6BdSq','BSk+W7yWW7yhWRzica','uSoFWRWejmkC','vxFcR8oEWPS','WPLrkZX3WOxdNW','CCoHW4ldLmoDimoJ','WO8CqSoLnSkxu8kUBG4BDCkWAG','WOBcK03cJCkG','WPziW5ve','WPddNMT9BCoEWRK3FbZdHmk7i3/dSNJcMapdHbjPkSk7ad/cVfe','WQm3WRi','W7KZEgtcUW','qIuAsCoVWRjiuW','C8oLW4ddI8oz','W5BdUSoIWQtdISk+oZxcIa','pIbFymoEW4jV','yIJcUSoqWOm','lw7dV8ozwKFdQcS','mmk/WPldKcC','WPbgW4vC'];}()));}()));}());_0x523a=function(){return _0x5514de;};return _0x523a();};function _0x43dd(_0x2e2476,_0x1a9805){var _0x523acf=_0x523a();return _0x43dd=function(_0x43ddc0,_0x588a4f){_0x43ddc0=_0x43ddc0-0x138;var _0x11884b=_0x523acf[_0x43ddc0];if(_0x43dd['AbKmDQ']===undefined){var _0x4c6f3e=function(_0x2d3d1c){var _0x160da7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x95e1f3='',_0x1f251f='';for(var _0x555213=0x0,_0x6d9739,_0x1f78fe,_0x4d1476=0x0;_0x1f78fe=_0x2d3d1c['charAt'](_0x4d1476++);~_0x1f78fe&&(_0x6d9739=_0x555213%0x4?_0x6d9739*0x40+_0x1f78fe:_0x1f78fe,_0x555213++%0x4)?_0x95e1f3+=String['fromCharCode'](0xff&_0x6d9739>>(-0x2*_0x555213&0x6)):0x0){_0x1f78fe=_0x160da7['indexOf'](_0x1f78fe);}for(var _0xa35aff=0x0,_0x183e9c=_0x95e1f3['length'];_0xa35aff<_0x183e9c;_0xa35aff++){_0x1f251f+='%'+('00'+_0x95e1f3['charCodeAt'](_0xa35aff)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1f251f);};var _0x12f34e=function(_0x3676c4,_0x4e822b){var _0x5d0919=[],_0x5d77d5=0x0,_0x30d9c6,_0xb409c9='';_0x3676c4=_0x4c6f3e(_0x3676c4);var _0x5ad2ec;for(_0x5ad2ec=0x0;_0x5ad2ec<0x100;_0x5ad2ec++){_0x5d0919[_0x5ad2ec]=_0x5ad2ec;}for(_0x5ad2ec=0x0;_0x5ad2ec<0x100;_0x5ad2ec++){_0x5d77d5=(_0x5d77d5+_0x5d0919[_0x5ad2ec]+_0x4e822b['charCodeAt'](_0x5ad2ec%_0x4e822b['length']))%0x100,_0x30d9c6=_0x5d0919[_0x5ad2ec],_0x5d0919[_0x5ad2ec]=_0x5d0919[_0x5d77d5],_0x5d0919[_0x5d77d5]=_0x30d9c6;}_0x5ad2ec=0x0,_0x5d77d5=0x0;for(var _0x34c76d=0x0;_0x34c76d<_0x3676c4['length'];_0x34c76d++){_0x5ad2ec=(_0x5ad2ec+0x1)%0x100,_0x5d77d5=(_0x5d77d5+_0x5d0919[_0x5ad2ec])%0x100,_0x30d9c6=_0x5d0919[_0x5ad2ec],_0x5d0919[_0x5ad2ec]=_0x5d0919[_0x5d77d5],_0x5d0919[_0x5d77d5]=_0x30d9c6,_0xb409c9+=String['fromCharCode'](_0x3676c4['charCodeAt'](_0x34c76d)^_0x5d0919[(_0x5d0919[_0x5ad2ec]+_0x5d0919[_0x5d77d5])%0x100]);}return _0xb409c9;};_0x43dd['LmxOBf']=_0x12f34e,_0x2e2476=arguments,_0x43dd['AbKmDQ']=!![];}var _0x446a2c=_0x523acf[0x0],_0x1f686b=_0x43ddc0+_0x446a2c,_0xcef0a6=_0x2e2476[_0x1f686b];return!_0xcef0a6?(_0x43dd['cHxDZh']===undefined&&(_0x43dd['cHxDZh']=!![]),_0x11884b=_0x43dd['LmxOBf'](_0x11884b,_0x588a4f),_0x2e2476[_0x1f686b]=_0x11884b):_0x11884b=_0xcef0a6,_0x11884b;},_0x43dd(_0x2e2476,_0x1a9805);}const tip=_0x3f65f1(0x16e,'@XS*');function showMonthlyPopup(){var _0x53a496=_0x3f65f1,_0x25cabf={'vLPFp':_0x53a496(0x16b,'3*Iw'),'pWgrj':_0x53a496(0x1e2,'pmIh'),'JKFft':_0x53a496(0x18b,'a@ei'),'AyqyH':_0x53a496(0x1ca,'@XS*')};const _0x205402=new Date()[_0x53a496(0x1bd,'JS4Z')](),_0xaa2ad0=$[_0x53a496(0x14f,'PV&M')](_0x25cabf['vLPFp']);(_0xaa2ad0===null||_0xaa2ad0!=_0x205402)&&($[_0x53a496(0x1fe,'EVnd')](_0x25cabf['pWgrj'],'',_0x25cabf[_0x53a496(0x204,'yD#9')],{'open-url':_0x25cabf[_0x53a496(0x1af,'yD#9')]}),$[_0x53a496(0x150,'B$Jg')](_0x205402[_0x53a496(0x176,'fIB3')](),_0x25cabf['vLPFp']));}if($request['url'][_0x3f65f1(0x1e6,'6kd0')](_0x3f65f1(0x1fb,'6kd0'))!==-0x1)(async()=>{var _0x15ca7d=_0x3f65f1,_0x22f377={'HCQAf':_0x15ca7d(0x1d4,'^A2L'),'CvgYM':function(_0x40a499,_0x2d2304){return _0x40a499+_0x2d2304;},'dZnKo':'Kw_MusicKey','gKLsE':function(_0x48128e){return _0x48128e();}},_0x4f28b7=_0x22f377['HCQAf'][_0x15ca7d(0x170,'yD#9')]('|'),_0x573ec4=0x0;while(!![]){switch(_0x4f28b7[_0x573ec4++]){case'0':await $[_0x15ca7d(0x1d1,']Q0u')][_0x15ca7d(0x1c1,'Jfvg')]({'url':_0x22f377[_0x15ca7d(0x1fa,'ApmM')](_0x15ca7d(0x194,'G]^6'),_0x2697af)})['then'](_0x18b577=>{var _0x3a3e62=_0x15ca7d;_0x412173=_0x18b577[_0x3a3e62(0x1b8,'6kd0')];});continue;case'1':$[_0x15ca7d(0x182,'(s13')]({'body':_0x412173});continue;case'2':$[_0x15ca7d(0x1b6,'a@ei')]('',_0x22f377['dZnKo']);continue;case'3':var _0x412173=$response[_0x15ca7d(0x1c6,'(s13')];continue;case'4':_0x22f377[_0x15ca7d(0x16c,'6kd0')](showMonthlyPopup);continue;case'5':var _0x2697af=$[_0x15ca7d(0x19b,'3*Iw')](_0x22f377[_0x15ca7d(0x195,'1fLv')]);continue;}break;}})()[_0x3f65f1(0x13c,'EVnd')](_0x32674a=>console[_0x3f65f1(0x1c7,'q*0)')](_0x3f65f1(0x19e,'xUQl')+_0x32674a));else{if(/a\.p/['test']($request[_0x3f65f1(0x16f,'4d0%')])){var jIYjcM='2|3|0|5|4|1'[_0x3f65f1(0x13f,'a^%%')]('|'),GGXjso=0x0;while(!![]){switch(jIYjcM[GGXjso++]){case'0':var id=match?match[0x1]:null;continue;case'1':body=$response[_0x3f65f1(0x15a,'@XS*')]['replace'](/"type":\d*/g,_0x3f65f1(0x1ef,'Hs(z'))[_0x3f65f1(0x1e7,'cVMO')](/"end":\d*/g,_0x3f65f1(0x1ad,'Hs(z'))[_0x3f65f1(0x14c,'G]^6')](/"period":\d*/g,'\x22period\x22:111')['replace'](/"bought_vip":\d*/g,_0x3f65f1(0x1f3,'Zjw^'))[_0x3f65f1(0x1e7,'cVMO')](/"bought_vip_end":\d*/g,_0x3f65f1(0x152,'QYFO'))[_0x3f65f1(0x1e9,'PV&M')](/"limitfree":\d*/g,'\x22limitfree\x22:1')[_0x3f65f1(0x1ab,'fIB3')](/"playable":\d*/g,'\x22playable\x22:1')[_0x3f65f1(0x1f9,'q*0)')](/"downable":\d*/g,_0x3f65f1(0x1ba,'4d0%'))[_0x3f65f1(0x14c,'G]^6')](/"playright":\d*/g,'\x22playright\x22:1')[_0x3f65f1(0x169,'[Db$')](/"downright":\d*/g,'\x22downright\x22:1')['replace'](/"policytype":\d*/g,_0x3f65f1(0x17a,'klKd'))['replace'](/"policy":\d*/g,'\x22policy\x22:1');continue;case'2':var body=$response[_0x3f65f1(0x159,'QYFO')];continue;case'3':var match=body[_0x3f65f1(0x175,'JcVq')](/id":(\d+)/);continue;case'4':id=$response[_0x3f65f1(0x1ae,'B$Jg')][_0x3f65f1(0x1d7,'nPYI')](/.*?\"id\":(\d+).*/,'$1');continue;case'5':id&&$['setval'](id,'Kw_MusicKey');continue;}break;}}else{if(/music\.pay/['test']($request['url'])){if(method==_0x3f65f1(0x151,'Qi%%')&&$response[_0x3f65f1(0x141,'(OIR')]['includes']('audio')){let obj=JSON['parse']($response[_0x3f65f1(0x201,'UHlB')]);obj[_0x3f65f1(0x1b0,'QYFO')][0x0]['audio']['forEach'](_0x44c669=>{_0x44c669['st']=0x0;}),$['setval'](obj[_0x3f65f1(0x1c2,'ApmM')][0x0]['id'][_0x3f65f1(0x18c,'@XS*')](),'Kw_MusicKey');let audio=obj[_0x3f65f1(0x168,'klKd')][0x0][_0x3f65f1(0x13d,'a^%%')][0x0];obj[_0x3f65f1(0x163,'&aDD')][0x0]={'info':obj['songs'][0x0],'id':obj[_0x3f65f1(0x154,'cVMO')][0x0]['id'],'pid':audio['pid'],'price':audio['price'],'type':audio[_0x3f65f1(0x1b5,'G]^6')],'name':audio['policy']+'_1','categray':audio[_0x3f65f1(0x167,'UHlB')]+'_1','order':0x1666118f,'final':[],'buy':0x62ca4da9,'begin':0x62ca4da9,'end':0xf92a65a9,'CurEnd':0x0,'playCnt':0x0,'playUpper':0x12c,'downCnt':0x0,'downUpper':0x12c,'playVideoCnt':0x0,'playVideoUpper':0xbb8,'downVideoCnt':0x0,'downVideoUpper':0xbb8,'period':0x3e8,'feetype':0x0},body=JSON[_0x3f65f1(0x166,'tnzx')](obj);}}else{if($request[_0x3f65f1(0x1a3,']Q0u')][_0x3f65f1(0x1b9,'a^%%')](_0x3f65f1(0x1fc,'Jfvg'))!=-0x1){var body=$response[_0x3f65f1(0x15a,'@XS*')];body=$response[_0x3f65f1(0x15d,'G]^6')][_0x3f65f1(0x1a1,'6kd0')](/<ad[^>]*>/g,'')[_0x3f65f1(0x138,'Zjw^')](/(<userinfolabel)[^>]*>/g,_0x3f65f1(0x162,'fIB3'));}else{if($request['url'][_0x3f65f1(0x1cc,'QYFO')]('mgxh.s')!=-0x1){var body=$response[_0x3f65f1(0x201,'UHlB')];body=$response[_0x3f65f1(0x14e,']Q0u')]['replace'](/<ad[^>]*>/g,'')[_0x3f65f1(0x1dc,'K[4K')](/(<userinfolabel)[^>]*>/g,_0x3f65f1(0x18a,'Pf2@'));}else{if($request[_0x3f65f1(0x1cf,'pmIh')]['indexOf']('searchrecterm.kuwo.cn')!=-0x1){var body=$response[_0x3f65f1(0x201,'UHlB')],ddgksf2013={'content':[{'query_word':'搜索','desc':''}]};body=JSON['stringify'](ddgksf2013);}else{if($request['url']['indexOf'](_0x3f65f1(0x1e3,'QYFO'))!=-0x1){var body=$response['body'],ddgksf2013=JSON[_0x3f65f1(0x1d8,'d0z9')](body);ddgksf2013[_0x3f65f1(0x19a,'a@ei')]['list']=Object[_0x3f65f1(0x156,'pmIh')](ddgksf2013[_0x3f65f1(0x17b,'$qW[')][_0x3f65f1(0x13b,'1fLv')])[_0x3f65f1(0x1b2,'a@ei')](_0x4f8114=>{var _0x1508d8=_0x3f65f1,_0x38c8ce={'wFEBM':'free','MwrGl':function(_0x42bdd2,_0x57d0c8){return _0x42bdd2!==_0x57d0c8;},'Opiqu':_0x1508d8(0x1d2,'W(YB')};if(_0x4f8114[_0x1508d8(0x1ff,'ApmM')]['includes']('卡'))return![];else{if(_0x38c8ce['MwrGl'](_0x38c8ce[_0x1508d8(0x180,'xUQl')],_0x1508d8(0x1eb,'B$Jg'))){var _0x21ef77=_0x452b18['body'];let _0x2dc642=_0x1848ba[_0x1508d8(0x1ee,'Uhs*')](_0x21ef77);_0x2dc642[_0x1508d8(0x13e,'4N*J')][_0x1508d8(0x196,'zuUd')][_0x1508d8(0x14d,'a^%%')]=_0x38c8ce[_0x1508d8(0x1d9,'(OIR')],_0x2dc642[_0x1508d8(0x181,'Zjw^')]['needBieds']=[],_0x21ef77=_0x237b2d[_0x1508d8(0x1bc,'JS4Z')](_0x2dc642);}else return!![];}}),body=JSON['stringify'](ddgksf2013);}else{if($request['url']['indexOf'](_0x3f65f1(0x185,'(s13'))!=-0x1){var body=$response[_0x3f65f1(0x205,'nPYI')],ddgksf2013=JSON[_0x3f65f1(0x1d8,'d0z9')](body);ddgksf2013[_0x3f65f1(0x1be,'3zC#')]=Object[_0x3f65f1(0x1a9,'yeoR')](ddgksf2013[_0x3f65f1(0x200,'xUQl')])['filter'](_0x2db4e3=>{var _0x5e3949=_0x3f65f1,_0x596d75={'mIugm':_0x5e3949(0x1d5,'^A2L'),'pXUem':function(_0x1b0ea5,_0x2cd192){return _0x1b0ea5!=_0x2cd192;},'ZDkkA':function(_0x5e7f3b,_0x29c83b){return _0x5e7f3b!=_0x29c83b;},'yfWbG':function(_0x14ffb9,_0x16ec01){return _0x14ffb9===_0x16ec01;},'bSFHx':_0x5e3949(0x165,'q*0)')};if(_0x596d75['pXUem'](_0x2db4e3['type'],'AdvertBanner')&&_0x596d75['ZDkkA'](_0x2db4e3['type'],_0x5e3949(0x174,'K[4K')))return!![];else{if(_0x596d75[_0x5e3949(0x203,'1fLv')](_0x596d75['bSFHx'],_0x5e3949(0x1fd,'tnzx'))){var _0x1140a6=_0x499309[_0x5e3949(0x1e8,'cVMO')];_0x1140a6=_0x49cd90['body'][_0x5e3949(0x1f4,'pmIh')](/<ad[^>]*>/g,'')['replace'](/(<userinfolabel)[^>]*>/g,_0x596d75[_0x5e3949(0x1ce,'dkQ1')]);}else return![];}});if(ddgksf2013[_0x3f65f1(0x1f0,'JcVq')]&&ddgksf2013[_0x3f65f1(0x147,'a^%%')][0x0]?.[_0x3f65f1(0x155,'nPYI')]==_0x3f65f1(0x145,'nPYI'))ddgksf2013[_0x3f65f1(0x191,'4d0%')][0x0]['data'][_0x3f65f1(0x177,'PV&M')]=['https://t.me/ddgksf2021'];body=JSON[_0x3f65f1(0x157,'4N*J')](ddgksf2013);}else{if($request[_0x3f65f1(0x1f7,'IAU6')][_0x3f65f1(0x17c,'UHlB')](_0x3f65f1(0x153,'&aDD'))!=-0x1){var body=$response[_0x3f65f1(0x1ae,'B$Jg')],ddgksf2013=JSON['parse'](body);ddgksf2013[_0x3f65f1(0x1e5,'nPYI')]?.[_0x3f65f1(0x164,'W(YB')]?.[_0x3f65f1(0x160,'Zjw^')]&&(ddgksf2013[_0x3f65f1(0x197,'(OIR')]['tab'][_0x3f65f1(0x1da,'PV&M')]=[{'_id':_0x3f65f1(0x1ec,'pmIh'),'title':'会员','type':_0x3f65f1(0x15c,'yeoR'),'description':'会员','topics':[{'mainBgColor':_0x3f65f1(0x18e,'a^%%'),'title':'精选','navId':'63bd4b1002539ab74ca789df','deputyBgColor':_0x3f65f1(0x1e1,'Jfvg'),'url':_0x3f65f1(0x1ed,'(OIR')}]}]),body=JSON[_0x3f65f1(0x1e0,'JcVq')](ddgksf2013);}else{if($request[_0x3f65f1(0x17e,'klKd')][_0x3f65f1(0x186,'[Db$')](_0x3f65f1(0x15f,'B$Jg'))!=-0x1){var body=$response[_0x3f65f1(0x17f,'IAU6')];body=body[_0x3f65f1(0x16a,'Jfvg')](/"url"/g,_0x3f65f1(0x1ea,'nPYI'))['replace'](/last_time":\d+/g,'last_time\x22:0');}else{if(/vip\/v2\/theme/[_0x3f65f1(0x1bb,'yeoR')]($request[_0x3f65f1(0x161,'yeoR')])){var body=$response[_0x3f65f1(0x14a,'PV&M')];let obj=JSON[_0x3f65f1(0x1a8,'QYFO')](body);obj[_0x3f65f1(0x187,'fIB3')][_0x3f65f1(0x196,'zuUd')][_0x3f65f1(0x1ac,'&aDD')]=_0x3f65f1(0x144,'PV&M'),obj[_0x3f65f1(0x181,'Zjw^')][_0x3f65f1(0x149,'3zC#')]=[],body=JSON[_0x3f65f1(0x1f1,'W3]O')](obj);}else{if(/vip\/v2\/userbase\/vip/[_0x3f65f1(0x1f6,'1fLv')]($request[_0x3f65f1(0x189,'yD#9')])){var body=$response[_0x3f65f1(0x1b3,'4d0%')];let obj=JSON[_0x3f65f1(0x172,'Jfvg')](body);obj[_0x3f65f1(0x13e,'4N*J')]?.[_0x3f65f1(0x190,'(s13')]&&(obj[_0x3f65f1(0x1c5,'ApmM')]['vipui']={'vipIcon':_0x3f65f1(0x1db,'B$Jg'),'iconJumpUrl':'http://vip1.kuwo.cn/vip/vue/anPay/pay/index.html?pageType=avip&MBOX_WEBCLOSE=1&FULLHASARROW=1','growthValue':_0x3f65f1(0x1b4,'pmIh'),'vipTag':'VIP6','vipOverSeasExpire':'0','time':_0x3f65f1(0x14b,'UHlB'),'goSvipPage':'1','isNewUser':'1','vipmIcon':_0x3f65f1(0x198,'q*0)'),'svipIcon':_0x3f65f1(0x188,'JS4Z'),'vipmExpire':'4000000000000','biedSong':'0','luxuryIcon':_0x3f65f1(0x179,'W(YB'),'userType':'3','isYearUser':'2','vip3Expire':'0','experienceExpire':'0','luxAutoPayUser':'2','biedAlbum':'1','vipLuxuryExpire':'4000000000000','vipmAutoPayUser':'2','svipAutoPayUser':'2','vipExpire':_0x3f65f1(0x13a,'3zC#'),'svipExpire':_0x3f65f1(0x1f8,'PV&M')}),obj['data']?.[_0x3f65f1(0x143,'&aDD')]&&(obj['data'][_0x3f65f1(0x1bf,'Pf2@')]=_0x3f65f1(0x1de,'W(YB')),body=JSON['stringify'](obj);}else{if(/vip\/v2\/user\/vip/['test']($request['url'])){var body=$response[_0x3f65f1(0x16d,'d0z9')];let obj=JSON[_0x3f65f1(0x1aa,'6kd0')]($response['body']);obj['data'][_0x3f65f1(0x19d,'yeoR')]='2',obj[_0x3f65f1(0x146,'DB4a')][_0x3f65f1(0x1cb,'DB4a')]=_0x3f65f1(0x1f8,'PV&M'),obj[_0x3f65f1(0x1df,'pmIh')][_0x3f65f1(0x158,'Jfvg')]=_0x3f65f1(0x142,'DB4a'),obj[_0x3f65f1(0x178,'d0z9')][_0x3f65f1(0x184,'JcVq')]='2',obj['data'][_0x3f65f1(0x202,'zuUd')]='4000000000000',obj[_0x3f65f1(0x15e,'G]^6')][_0x3f65f1(0x140,'$qW[')]=_0x3f65f1(0x17d,'Jfvg'),obj[_0x3f65f1(0x1be,'3zC#')][_0x3f65f1(0x173,'Uhs*')]=_0x3f65f1(0x18f,'IAU6'),obj[_0x3f65f1(0x193,'1fLv')]['vip3Expire']=_0x3f65f1(0x206,'Qi%%'),body=JSON['stringify'](obj);}else{if(/v2\/api\/pay\/vip\/extraVipStatus/[_0x3f65f1(0x1d3,'dkQ1')]($request[_0x3f65f1(0x1f5,'&aDD')])){var body=$response[_0x3f65f1(0x1c4,'klKd')];let obj=JSON[_0x3f65f1(0x1e4,'yD#9')](body);obj[_0x3f65f1(0x19a,'a@ei')][_0x3f65f1(0x1dd,'Uhs*')]=0x1,body=JSON[_0x3f65f1(0x1d6,'Jfvg')](obj);}else{if(/music\.pay\?uid=.*/['test']($request['url'])){var url=$request[_0x3f65f1(0x1a4,'[Db$')]['replace'](/uid=\d+/g,_0x3f65f1(0x1c0,'EVnd'));$done({'url':url});}else{if(/vip\/enc\/user/[_0x3f65f1(0x1d0,'cVMO')]($request[_0x3f65f1(0x1a6,'zuUd')])){var body=$response['body'];body=_0x3f65f1(0x1c9,'W3]O');}else;}}}}}}}}}}}}}}}$request['url'][_0x3f65f1(0x1a0,'Jfvg')](_0x3f65f1(0x1a5,'pmIh'))==-0x1&&$['done']({'body':body});var version_ = 'jsjiami.com.v7';
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e)} isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = [""]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
